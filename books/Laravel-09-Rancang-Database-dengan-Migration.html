<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="/assets/images/logo.ico" type="image/x-icon">
    <link rel="stylesheet" href="/assets/css/fontawesome-all.css">
    <link rel="stylesheet" href="/assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="/assets/css/styles.css">
    <link rel="stylesheet" href="/assets/css/tango.css">
    <title>Rancang Database dengan Migration</title>
    <link type="application/atom+xml" rel="alternate" href="/feed.xml" />
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Rancang Database dengan Migration</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Rancang Database dengan Migration" />
<meta name="author" content="Muhammad Fajri" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Bismillahirrahmanirrahim." />
<meta property="og:description" content="Bismillahirrahmanirrahim." />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-04-02T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Rancang Database dengan Migration" />
<script type="application/ld+json">
{"url":"/books/Laravel-09-Rancang-Database-dengan-Migration.html","mainEntityOfPage":{"@type":"WebPage","@id":"/books/Laravel-09-Rancang-Database-dengan-Migration.html"},"author":{"@type":"Person","name":"Muhammad Fajri"},"@type":"BlogPosting","description":"Bismillahirrahmanirrahim.","headline":"Rancang Database dengan Migration","dateModified":"2021-04-02T00:00:00+08:00","datePublished":"2021-04-02T00:00:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    
        





    
</head>
<body>
    <div class="container-fluid">
        <div id="toTop" onclick="gotoTop()"><span class="fas fa-angle-up"></span></div>

        <header class="jumbotron p-sm-3 mb-0">
    <h1 class="display-4"><a href="/">Fajri CodeOS<small class="lead d-block mt-2">Learn Basic Technology</small></a></h1>
</header>
<nav class="navbar sticky-top navbar-expand-lg navbar-dark bg-dark">
    <span class="navbar-brand d-lg-none">Menu</span>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
            
            <li class="mt-2 mb-1 mt-sm-2 mb-sm-1 m-lg-0 nav-item">
                <a class=" mr-lg-2 px-3 rounded nav-link" href="/"> <span class="fas fa-home"></span> Home <span class="sr-only">(current)</span></a>
            </li>
            
            <li class="mt-2 mb-1 mt-sm-2 mb-sm-1 m-lg-0 nav-item">
                <a class=" mr-lg-2 px-3 rounded nav-link" href="/blog/"> <span class="fas fa-book-reader"></span> Blog <span class="sr-only">(current)</span></a>
            </li>
            
            <li class="mt-2 mb-1 mt-sm-2 mb-sm-1 m-lg-0 nav-item">
                <a class=" mr-lg-2 px-3 rounded nav-link" href="/book.html"> <span class="fas fa-book-open"></span> Books <span class="sr-only">(current)</span></a>
            </li>
            
            <li class="mt-2 mb-1 mt-sm-2 mb-sm-1 m-lg-0 nav-item">
                <a class=" mr-lg-2 px-3 rounded nav-link" href="/contact.html"> <span class="fas fa-phone-alt"></span> Contact <span class="sr-only">(current)</span></a>
            </li>
            
            <li class="mt-2 mb-1 mt-sm-2 mb-sm-1 m-lg-0 nav-item">
                <a class=" mr-lg-2 px-3 rounded nav-link" href="/about.html"> <span class="fas fa-info-circle"></span> About <span class="sr-only">(current)</span></a>
            </li>
            
        </ul>
        <form class="d-flex mt-2">
            <input class="form-control mr-2" type="search" placeholder="Search" aria-label="Search">
            <button class="btn" type="submit"><span class="fas fa-search"></span></button>
        </form>
    </div>
</nav>
        
        <article class="ml-lg-5 mr-lg-3">
            <div class="social-btn">
                <a class="fb" href="https://www.facebook.com/fajri.codeOS/"><span class="fab fa-facebook"></span></a>
                <a class="ig" href="https://www.instagram.com/mhd_fajri15/"><span class="fab fa-instagram"></span></a>
                <a class="github" href="https://www.github.com/muh-fajri/"><span class="fab fa-github"></span></a>
                <a class="linkedin" href="https://linkedin.com/in/muhammadfajri/"><span class="fab fa-linkedin"></span></a>
                <a class="email" href="mailto:muhammadfajriw@gmail.com"><span class="fas fa-envelope"></span></a>
            </div>
            <section id="date-time">
                <p><!-- Don't make change here --></p>
            </section>
            <section aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/"><span class="fas fa-home"></span> Home</a></li>
        <li class="breadcrumb-item"><a href="/book.html"><span class="fas fa-book-open"></span> Books</a></li>
        <li class="text-dark breadcrumb-item active" aria-current="page">Rancang Database dengan Migration</li>
    </ol>
</section>
<section id="post">
    <div class="card">
        <div class="card-body">
            <h2>Rancang Database dengan Migration</h2>
            <div class="post-attribute d-sm-flex">
                <div class="author-post">
                    <img src="/assets/images/author.jpg" alt="author">
                    <span class="fas fa-user"></span>
                    <a href="/author.html">Muhammad Fajri</a>
                </div>
                <div class="date-post">
                    <span class="fas fa-calendar-alt"></span>
                    <span>Friday, 02 April 2021</span>
                </div>
            </div>

            <p>Bismillahirrahmanirrahim.</p>

<p>Dilanjutkan kemudian…</p>

<!-- Hapus seluruh isi file *migrations* yang ada pada folder `database\migrations`.

### Membuat File Migrasi

Untuk membuat file migration, jalankan perintah:
```bash
php artisan make:migration create_students_table
```

Outputnya:
```bash
Created Migration: 2021_04_02_102318_create_students_table
```

- `php`, untuk menjalankan PHP (dibutuhkan oleh Artisan CLI).
- `artisan`, memanggil artisan itu sendiri.
- `make:`, perintah untuk membuat folder baru diikuti parameter `migration` yang menunjukkan bahwa kita akan membuat file *migration*. Untuk file lainnya, ganti parameter `migration` sesuai kebutuhan.
- `create_students_table`, parameter yang menginformasikan Artisan bahwa *file migration* yang akan dibuat adalah tabel students. Perlu diperhatikan bahwa awalan `create_` sebagai informasi untuk membuat tabel. Dengan demikian, Artisan akan men-*generate* *file migration* dengan lebih lengkap jika tanpa awalan `create_`.

Isi file yang dihasilkan dapat dilihat pada file migration ter-*generate* di folder `database`.

```php
<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateStudentsTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('students', function (Blueprint $table) {
            $table->id();
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::dropIfExists('students');
    }
}
```

> Salah satu tips yang juga sangat berguna adalah mengikuti aturan penamaan standar Laravel, hal ini sangat membantu kita. Contoh yang bisa kita terapkan dalam pembuatan file *migration* adalah pada Laravel nama sebuah tabel ditandai dengan kata jamak sedangkan untuk modelnya dikenali dengan dengan kata tunggal. Artinya untuk model dengan nama `User` akan dipadankan dengan tabel dengan nama `users` dan untuk model dengan nama `Book` akan dipadankan dengan tabel dengan nama `books`. Jika kita tidak mengikuti aturan penamaan ini, kita perlu menentukan secara manual apa nama tabel yang berpadanan dengan model kita.

### Melengkapi File Migrasi

Lengkapi fungsi `up()` pada file *migration* `create_students_table`:
```bash
<?php
...
class CreateStudentsTable extends Migration
{
    public function up()
    {
        Schema::create('students', function (Blueprint $table) {
            $table->bigIncrements('id');
            $table->string('nama');
            $table->string('nim');
            $table->string('kelas');
            $table->string('jurusan');
            $table->unsignedInteger('angkatan');
            $table->timestamps();
        });
    }
...
}
```

### Mengeksekusi File Migrasi

Kita akan gunakan Artisan CLI untuk mengeksekusi file migrasi. Pastikan konfigurasi koneksi ke *database* sudah dilakukan di file `.env`.
```bash
php artisan migrate
```

Setelah dijalankan *error* berikut ditemui:
```bash
   Illuminate\Database\QueryException 

  could not find driver (SQL: select * from information_schema.tables where table_schema = blog and table_name = migrations and table_type = 'BASE TABLE')

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:678
    674▕         // If an exception occurs when attempting to run a query, we'll format the error                                                     
    675▕         // message to include the bindings with SQL, which will make this exception a                                                        
    676▕         // lot more helpful to the developer instead of just the database's errors.                                                          
    677▕         catch (Exception $e) {
  ➜ 678▕             throw new QueryException(
    679▕                 $query, $this->prepareBindings($bindings), $e
    680▕             );
    681▕         }
    682▕ 

      +33 vendor frames 
  34  artisan:37
      Illuminate\Foundation\Console\Kernel::handle()
```

Saat mencari referensi *error* tersebut, ditemukan forum yang memberikan solusi untuk meng-*enable* `;extension=php_pdo_mysql.dll` di dalam file `php.ini`.

```
sudo nano /etc/php/php.ini
```

Saya menemukan baris `;extension=pdo_mysql` dan langsung saja saya hilangkan tanda `;`, kemudian menyimpan dan menutup file.

Saat ini dieksekusi kembali perintah `php artisan migrate` dan didapati error berikut:
```bash
...
  SQLSTATE[HY000] [1049] Unknown database 'blog' (SQL: select * from information_schema.tables where table_schema = blog and table_name = migrations and table_type = 'BASE TABLE')
...
```

Untuk mengatasiya, buat database dengan nama `blog` terlebih dahulu. Saya melakukannya melalui *command line*. Jalankan perintah berikut untuk dapat mengakses database.
```bash
mysql -p -u root
Enter password: #Type your password
```

Kemudian membuat database-nya:
```bash
create database blog;
```

Selanjutnya dieksekusi kembali `php artisan migrate` dan didapati output seperti ini:
```bash
Migration table created successfully.
Migrating: 2021_04_02_102318_create_students_table
Migrated:  2021_04_02_102318_create_students_table (271.52ms)
```

Setelah diperiksa di database baik melalui phpMyAdmin atau dari *command line* dapat dilihat telah ada tabel baru dengan nama `migrate` dan `students` di dalam database `blog`. Berikut isi tabelnya saat dilakukan perintah `SELECT`.
```bash
MariaDB [blog]> select * from migrations;
+----+-----------------------------------------+-------+
| id | migration                               | batch |
+----+-----------------------------------------+-------+
|  1 | 2021_04_02_102318_create_students_table |     1 |
+----+-----------------------------------------+-------+
1 row in set (0.024 sec)

MariaDB [blog]> select * from students;
Empty set (0.064 sec)
```

Isi tabel `students` masih kosong. Untuk melihat struktur filenya jalankan perintah `DESC`.

```bash
MariaDB [blog]> DESC students;
+------------+---------------------+------+-----+---------+----------------+
| Field      | Type                | Null | Key | Default | Extra          |
+------------+---------------------+------+-----+---------+----------------+
| id         | bigint(20) unsigned | NO   | PRI | NULL    | auto_increment |
| nama       | varchar(255)        | NO   |     | NULL    |                |
| nim        | varchar(255)        | NO   |     | NULL    |                |
| kelas      | varchar(255)        | NO   |     | NULL    |                |
| jurusan    | varchar(255)        | NO   |     | NULL    |                |
| angkatan   | int(10) unsigned    | NO   |     | NULL    |                |
| created_at | timestamp           | YES  |     | NULL    |                |
| updated_at | timestamp           | YES  |     | NULL    |                |
+------------+---------------------+------+-----+---------+----------------+
8 rows in set (0.116 sec)
```

Dengan demikian, pembuatan tabel dengan php Artisan telah berhasil.

### Referensi

- [...](https://medium.com/easyread/apa-itu-artisan-cli-pada-laravel-62a94232a29a)
- [Artisan migrate could not find driver](https://stackoverflow.com/questions/46745365/artisan-migrate-could-not-find-driver) -->


            <hr>
            <div class="share">
                <p class="text-center">
                    Share on : <br>
                    <a href="http://www.facebook.com/sharer.php?u=https://muh-fajri.github.io/books/Laravel-09-Rancang-Database-dengan-Migration.html"><span class="fab fa-facebook"></span></a>
                    <a href="http://twitter.com/share?url=https://muh-fajri.github.io/books/Laravel-09-Rancang-Database-dengan-Migration.html"><span class="fab fa-twitter"></span></a>
                    <a href="http://www.linkedin.com/shareArticle?mini=true&url=https://muh-fajri.github.io/books/Laravel-09-Rancang-Database-dengan-Migration.html&title=Rancang Database dengan Migration&summary="><span class="fab fa-linkedin"></span></a>
                    <a href="https://api.whatsapp.com/send?text=Rancang Database dengan Migration%20%2D%20https://muh-fajri.github.io/books/Laravel-09-Rancang-Database-dengan-Migration.html"><span class="fab fa-whatsapp"></span></a>
                    <a href="https://telegram.me/share/url?url=https://muh-fajri.github.io/books/Laravel-09-Rancang-Database-dengan-Migration.html&text=Rancang Database dengan Migration"><span class="fab fa-telegram"></span></a>
                </p>
            </div>
            <hr>
        </div>
    </div>
</section>
        </article>

        <footer class="d-flex flex-column mb-5 mb-sm-5 mb-lg-0 mt-lg-5">
    <ul>
        <li><a href="/contact.html">Contact</a></li>
        <li><a href="/about.html">About</a></li>
        <li><a href="#">Privacy</a></li>
        <li><a href="#">Disclaimer</a></li>
    </ul>
    <div class="credit">
        <p class="mb-0">&copy; 2021 - <a class="p-0" href="/author.html">Muhammad Fajri</a></p>
    </div>
</footer>
    
    </div>

    <script src="/assets/js/fontawesome-all.js"></script>
    <script src="/assets/js/jquery-3.5.1.min.js"></script>
    <script src="/assets/js/bootstrap.min.js"></script>
    <script src="/assets/js/script.js"></script>
</body>
</html>